<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>√úreten Eller ‚Ä¢ Home</title>
  <meta name="theme-color" content="#111827" />
  <style>
    :root{
      --ink:#0f172a; --muted:#475569; --paper:rgba(255,255,255,.86); --line:rgba(255,255,255,.45);
      --brand:#111827; --accent:#6366f1; --bg1:#ff80ab; --bg2:#a78bfa; --bg3:#60a5fa; --bg4:#34d399;
    }
    html,body{min-height:100%}
    body{margin:0; color:var(--ink); font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:
        radial-gradient(1200px 800px at -10% -10%, rgba(255,255,255,.35), transparent 60%),
        linear-gradient(120deg, var(--bg1),var(--bg2),var(--bg3),var(--bg4));
      background-size:320% 320%; animation:drift 16s ease-in-out infinite; padding-bottom: env(safe-area-inset-bottom); /* fixed bottom bar safe area */
    }
    /* Ensure page can grow and legal stays visible above bottom bar */
    body{min-height:100vh}
    @keyframes drift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    /* Top App Bar */
    .topbar{position:sticky; top:0; z-index:50; display:flex; align-items:center; gap:10px;
      padding:10px 14px; backdrop-filter:blur(10px); background:var(--paper); border-bottom:1px solid var(--line)}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800}
    .brand img{border-radius:12px; box-shadow:0 6px 16px rgba(0,0,0,.15)}
    .grow{flex:1}
    .nav{display:flex; gap:8px; align-items:center}
    .btn{border:1px solid #e5e7eb; background:#fff; color:#111827; border-radius:12px; padding:8px 12px; font-weight:700; cursor:pointer}
    .btn.ghost{background:#fff}
    .btn.dark{background:#111827; color:#fff; border-color:#111827}

    /* Language switch */
    .lang{display:flex; align-items:center; gap:6px; padding:4px 8px; border:1px solid #e5e7eb; background:#fff; border-radius:12px}
    .lang select{border:none; background:transparent; font-weight:700; cursor:pointer}

    /* Hero */
    .hero{display:grid; place-items:center; text-align:center; padding:26px 16px 12px}
    .hero img{width:84px; height:84px; border-radius:20px; box-shadow:0 10px 24px rgba(0,0,0,.18)}
    .hero h1{margin:8px 0 2px; font-size:30px; letter-spacing:.2px}
    .phrase{margin-top:10px; font-size:18px; color:#111827; animation:fade .6s ease}
    @keyframes fade{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}

    /* Categories */
    .catsWrap{max-width:1100px; margin:0 auto; padding:0 14px 14px}
    .catsCard{background:transparent; border:none; border-radius:0; padding:0; box-shadow:none}
    .catsCard h3{margin:4px 0 12px}
    .cats{display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .cat{border:1px solid #0b0b0f22; background:#0b0b0f; color:#f8fafc; border-radius:16px; padding:12px; position:relative; overflow:hidden}
    .cat h4{margin:0 0 6px; font-size:16px}
    .subs{display:flex; flex-wrap:wrap; gap:6px}
    .subs .s{border:1px solid #ffffff33; background:#111827; color:#e5e7eb; border-radius:999px; padding:5px 8px; font-size:12px}
    .more{display:inline-block; margin-top:8px; text-decoration:none; font-weight:700; color:#fff}

    /* Ads (showcase & latest) */
    .sec{max-width:1100px;margin:0 auto;padding:0 14px 16px}
    .sec h3{margin:8px 0 10px}
    .adsGrid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .adCard{background:#fff;border:1px solid #e5e7eb;border-radius:16px;overflow:hidden}
    .adThumb{width:100%;aspect-ratio:4/3;background:#f1f5f9}
    .adBody{padding:10px}
    .adTitle{margin:0 0 6px;font-weight:700;font-size:14px;line-height:1.3}
    .adMeta{display:flex;justify-content:space-between;align-items:center;color:#475569;font-size:13px}

    /* Dark colorful backgrounds for category cards */
    .cat::before{content:""; position:absolute; inset:-40%; filter:blur(60px); opacity:.6}
    .cat.c1::before{background:radial-gradient(circle at 30% 30%, #ff80ab, transparent 60%)}
    .cat.c2::before{background:radial-gradient(circle at 70% 20%, #a78bfa, transparent 60%)}
    .cat.c3::before{background:radial-gradient(circle at 30% 70%, #60a5fa, transparent 60%)}
    .cat.c4::before{background:radial-gradient(circle at 70% 80%, #34d399, transparent 60%)}
    .cat.c5::before{background:radial-gradient(circle at 50% 50%, #f59e0b, transparent 60%)}

    /* Legal links */
    .legal{max-width:1100px; margin:16px auto 0; padding:0 14px 8px}
    .legal .links{display:flex; flex-wrap:wrap; gap:10px; justify-content:center}
    .legal a{border:1px solid #e5e7eb; background:#fff; color:#111827; border-radius:999px; padding:8px 12px; font-weight:600; text-decoration:none}

    /* Bottom bar */
    .bottombar{position:fixed; left:0; right:0; bottom:0; z-index:40; display:flex; justify-content:space-around; gap:8px; padding:10px; background:var(--paper); border-top:1px solid var(--line); backdrop-filter:blur(10px)}
    .iconbtn{position:relative; display:inline-grid; place-items:center; width:42px; height:42px; border-radius:12px; border:1px solid #e5e7eb; background:#fff; cursor:pointer}
    .mini{display:grid; place-items:center; gap:4px; font-size:12px}

    /* Support bubble */
    .support{position:fixed; right:16px; bottom:78px; z-index:70}
    .support .bubble{width:56px; height:56px; border-radius:999px; background:#111827; color:#fff; display:grid; place-items:center; font-size:22px; cursor:pointer; box-shadow:0 16px 36px rgba(0,0,0,.25)}
    .support .window{position:fixed; right:16px; bottom:146px; width:320px; max-width:calc(100% - 32px); background:#fff; border:1px solid #e5e7eb; border-radius:16px; box-shadow:0 20px 50px rgba(0,0,0,.2); display:none}
    .support .window.open{display:block}
    .support header{display:flex; align-items:center; justify-content:space-between; padding:10px; border-bottom:1px solid #e5e7eb}
    .support .log{padding:10px; display:grid; gap:8px; max-height:40vh; overflow:auto}
    .support .me{justify-self:end; background:#111827; color:#fff; padding:8px 10px; border-radius:12px; max-width:85%}
    .support .bot{justify-self:start; background:#f8fafc; border:1px solid #e5e7eb; padding:8px 10px; border-radius:12px; max-width:85%}
    .support .composer{display:flex; gap:8px; padding:10px; border-top:1px solid #e5e7eb}
    .support input{flex:1; padding:10px 12px; border:1px solid #e5e7eb; border-radius:12px}

    /* Utilities */
    .hide{display:none !important}
    .right{display:flex; align-items:center; gap:8px}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="/assets/images/logo.png" width="32" height="32" alt="logo" />
      <span id="brandTxt">√úreten Eller</span>
    </div>
    <div class="grow"></div>
    <nav class="nav">
      <button id="postListing" class="btn dark"><span data-i="post">ƒ∞lan Ver</span> ‚ûï</button>
      <div class="lang">
        <span>üåê</span>
        <select id="langSel" aria-label="Language">
          <option value="tr">T√ºrk√ße</option>
          <option value="en">English</option>
          <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
          <option value="de">Deutsch</option>
        </select>
      </div>
      <div class="right">
        <button id="profileBtn" class="btn ghost">üë§ <span data-i="profile">Profil</span></button>
        <button id="logoutBtn" class="btn dark">‚éã <span data-i="logout">√áƒ±kƒ±≈ü</span></button>
      </div>
    </nav>
  </header>

  <section class="hero">
    <img src="/assets/images/logo.png" alt="logo" />
    <h1 id="welcomeTitle">√úRETEN ELLERE Ho≈ü geldiniz!</h1>
    <div id="phraseBox" class="phrase">Amacƒ±mƒ±z: ev hanƒ±mlarƒ±na b√ºt√ße katkƒ±sƒ± saƒülamak.</div>
  </section>

  <section class="sec" id="showcaseWrap">
    <h3 id="showcaseHead">Vitrin</h3>
    <div class="adsGrid" id="showcaseGrid"></div>
  </section>

  <section class="sec" id="latestWrap">
    <h3 id="latestHead">Son 20 ƒ∞lan</h3>
    <div class="adsGrid" id="latestGrid"></div>
  </section>

  <section class="catsWrap">
    <article class="catsCard" id="catsCard">
      <h3 data-i="cats">Kategoriler</h3>
      <div class="cats" id="catsGrid"></div>
    </article>
  </section>

  <!-- Legal links at absolute bottom (but above fixed bar) -->
  <section class="legal">
    <div class="links" id="legalLinks"></div>
  </section>

  <footer class="bottombar">
    <div class="mini"><button id="homeBtnB" class="iconbtn" title="Anasayfa">üè†</button><span data-i="home">Anasayfa</span></div>
    <div class="mini"><button id="msgBtnB" class="iconbtn" title="Mesajlar">üí¨</button><span data-i="messages">Mesajlar</span></div>
    <div class="mini"><button id="notiBtnB" class="iconbtn" title="Bildirimler">üîî</button><span data-i="notifications">Bildirimler</span></div>
  </footer>

  <!-- Live Support Bubble -->
  <div class="support">
    <div id="supportWin" class="window" role="dialog" aria-modal="true" aria-label="Sohbet">
      <header>
        <strong id="supTitle">Canlƒ± Destek</strong>
        <button id="supClose" class="btn ghost">‚úï</button>
      </header>
      <div id="supLog" class="log" aria-live="polite"></div>
      <div class="composer">
        <input id="supInput" placeholder="Mesaj yaz‚Ä¶" />
        <button id="supSend" class="btn dark">G√∂nder</button>
      </div>
    </div>
    <div id="supportBtn" class="bubble" title="Canlƒ± Destek">üí¨</div>
  </div>

  <script>
    // ---- Localization ----
    const STR = {
      tr: {
        brand: "√úreten Eller",
        home: "Anasayfa",
        messages: "Mesajlar",
        notifications: "Bildirimler",
        profile: "Profil",
        logout: "√áƒ±kƒ±≈ü",
        post: "ƒ∞lan Ver",
        cats: "Kategoriler",
        more: "Devamƒ± ‚Üí",
        welcomeTitle: (name)=> name ? `√úRETEN ELLERE Ho≈ü geldin, ${name}!` : "√úRETEN ELLERE Ho≈ü geldiniz!",
        welcomeSub: "Sade ve g√ºvenli ana sayfa",
        support: { title:"Canlƒ± Destek", hello:"Merhaba! Size nasƒ±l yardƒ±mcƒ± olabilirim?", sent:"Mesajƒ±nƒ±z alƒ±ndƒ±." },
        legal: {
          privacy: "Gizlilik",
          about: "Hakkƒ±mƒ±zda",
          contact: "ƒ∞leti≈üim",
          terms: "Kullanƒ±m ≈ûartlarƒ±",
          kvkk: "KVKK Aydƒ±nlatma",
          distance: "Mesafeli Satƒ±≈ü S√∂zle≈ümesi",
          returns: "Teslimat & ƒ∞ade"
        }
      },
      en: {
        brand: "Ureten Eller",
        home: "Home",
        messages: "Messages",
        notifications: "Notifications",
        profile: "Profile",
        logout: "Logout",
        post: "Post Listing",
        cats: "Categories",
        more: "More ‚Üí",
        welcomeTitle: (name)=> name ? `Welcome to Ureten Eller, ${name}!` : "Welcome to Ureten Eller!",
        welcomeSub: "Simple and secure homepage",
        support: { title:"Live Support", hello:"Hello! How can I help?", sent:"We received your message." },
        legal: {
          privacy: "Privacy",
          about: "About",
          contact: "Contact",
          terms: "Terms",
          kvkk: "KVKK Notice",
          distance: "Distance Sales Agreement",
          returns: "Shipping & Returns"
        }
      },
      ar: {
        brand: "ÿ£ŸèŸÜÿ™Ÿêÿ¨ ÿ®ÿßŸÑÿ£ŸäÿßÿØŸä",
        home: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
        messages: "ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ",
        notifications: "ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™",
        profile: "ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä",
        logout: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
        post: "ÿ£ŸÜÿ¥ÿ¶ ÿ•ÿπŸÑÿßŸÜŸãÿß",
        cats: "ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™",
        more: "ÿßŸÑŸÖÿ≤ŸäÿØ ‚Üí",
        welcomeTitle: (name)=> name ? `ŸÖÿ±ÿ≠ÿ®Ÿãÿß ÿ®ŸÉŸÖ ŸÅŸä ÿ£ŸèŸÜÿ™Ÿêÿ¨ ÿ®ÿßŸÑÿ£ŸäÿßÿØŸäÿå ${name}!` : "ŸÖÿ±ÿ≠ÿ®Ÿãÿß ÿ®ŸÉŸÖ ŸÅŸä ÿ£ŸèŸÜÿ™Ÿêÿ¨ ÿ®ÿßŸÑÿ£ŸäÿßÿØŸä!",
        welcomeSub: "ÿµŸÅÿ≠ÿ© ÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿ®ÿ≥Ÿäÿ∑ÿ© Ÿàÿ¢ŸÖŸÜÿ©",
        support: { title:"ÿØÿπŸÖ ŸÖÿ®ÿßÿ¥ÿ±", hello:"ÿ£ŸáŸÑŸãÿß! ŸÉŸäŸÅ ÿ£ÿ≥ÿßÿπÿØŸÉÿü", sent:"ÿ™ŸÖ ÿßÿ≥ÿ™ŸÑÿßŸÖ ÿ±ÿ≥ÿßŸÑÿ™ŸÉ." },
        legal: {
          privacy: "ÿßŸÑÿÆÿµŸàÿµŸäÿ©",
          about: "ŸÖŸÜ ŸÜÿ≠ŸÜ",
          contact: "ÿßÿ™ÿµÿßŸÑ",
          terms: "ÿßŸÑÿ¥ÿ±Ÿàÿ∑",
          kvkk: "ÿ•ÿ¥ÿπÿßÿ± KVKK",
          distance: "ÿßÿ™ŸÅÿßŸÇŸäÿ© ÿßŸÑÿ®Ÿäÿπ ÿπŸÜ ÿ®ÿπÿØ",
          returns: "ÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ ŸàÿßŸÑÿ•ÿ±ÿ¨ÿßÿπ"
        }
      },
      de: {
        brand: "Ureten Eller",
        home: "Startseite",
        messages: "Nachrichten",
        notifications: "Benachr.",
        profile: "Profil",
        logout: "Abmelden",
        post: "Anzeige erstellen",
        cats: "Kategorien",
        more: "Mehr ‚Üí",
        welcomeTitle: (name)=> name ? `Willkommen bei Ureten Eller, ${name}!` : "Willkommen bei Ureten Eller!",
        welcomeSub: "Einfache & sichere Startseite",
        support: { title:"Live-Support", hello:"Hallo! Wie kann ich helfen?", sent:"Nachricht erhalten." },
        legal: {
          privacy: "Datenschutz",
          about: "√úber uns",
          contact: "Kontakt",
          terms: "Nutzungsbedingungen",
          kvkk: "KVKK-Hinweis",
          distance: "Fernabsatzvertrag",
          returns: "Lieferung & R√ºckgabe"
        }
      }
    };

    // Fill default labels for new sections
    (function ensureLabels(){
      STR.tr.showcase = STR.tr.showcase || 'Vitrin';
      STR.tr.latest20 = STR.tr.latest20 || 'Son 20 ƒ∞lan';
      STR.tr.noAds = STR.tr.noAds || 'Hen√ºz ilan yok.';
      STR.en.showcase = STR.en.showcase || 'Showcase';
      STR.en.latest20 = STR.en.latest20 || 'Latest 20';
      STR.en.noAds = STR.en.noAds || 'No listings yet.';
      STR.ar.showcase = STR.ar.showcase || 'ÿßŸÑÿπÿ±ÿ∂';
      STR.ar.latest20 = STR.ar.latest20 || 'ÿ¢ÿÆÿ± 20 ÿ•ÿπŸÑÿßŸÜ';
      STR.ar.noAds = STR.ar.noAds || 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ•ÿπŸÑÿßŸÜÿßÿ™ ÿ®ÿπÿØ.';
      STR.de.showcase = STR.de.showcase || 'Vitrine';
      STR.de.latest20 = STR.de.latest20 || 'Letzte 20';
      STR.de.noAds = STR.de.noAds || 'Noch keine Inserate.';
    })();

    // Categories (multi-lang)
    const CATS = {
      tr: [
        { t:"Yemekler", icon:"üçΩÔ∏è", s:["Ev yemekleri","B√∂rek-√ß√∂rek","√áorba","Zeytinyaƒülƒ±","Pilav-makarna"] },
        { t:"Pasta & Tatlƒ±", icon:"üéÇ", s:["Ya≈ü pasta","Kurabiye","S√ºtl√º tatlƒ±"] },
        { t:"Re√ßel ‚Ä¢ Tur≈üu ‚Ä¢ Sos", icon:"üçØ", s:["Re√ßel","Tur≈üu","Domates/biber sos"] },
        { t:"Y√∂resel / Kƒ±≈ülƒ±k", icon:"üß∫", s:["Eri≈üte","Tarhana","Mantƒ±"] },
        { t:"Diyet / Vegan / GF", icon:"ü•ó", s:["Fit tabaklar","Vegan","Glutensiz"] },
        { t:"Takƒ±", icon:"üíç", s:["Bileklik","Kolye","K√ºpe"] },
        { t:"Bebek & √áocuk", icon:"üß∏", s:["Rattle","Patik","Battaniye"] },
        { t:"√ñrg√º / Triko", icon:"üßµ", s:["Hƒ±rka","Atkƒ±","≈ûal"] },
        { t:"Diki≈ü / Terzilik", icon:"‚úÇÔ∏è", s:["Pa√ßa","Fermuar","√ñzel dikim"] },
        { t:"Makrome & Dekor", icon:"ü™¢", s:["Duvar s√ºs√º","Saksƒ± askƒ±sƒ±","Anahtarlƒ±k"] },
        { t:"Ev Dekor & Aksesuar", icon:"üè†", s:["Kƒ±rlent","Kapƒ± s√ºs√º","√áer√ßeve"] },
        { t:"Mum & Kokulu", icon:"üïØÔ∏è", s:["Soya/balmumu","Oda spreyi","Hediye seti"] },
        { t:"Doƒüal Sabun & Kozmetik", icon:"üßº", s:["Zeytinyaƒülƒ± sabun","Katƒ± ≈üampuan","Dudak balmƒ±"] },
        { t:"Amigurumi & Oyuncak", icon:"üß∂", s:["Anahtarlƒ±k","Magnet","Fig√ºr"] },
      ],
      en: [
        { t:"Meals", icon:"üçΩÔ∏è", s:["Home meals","Savory bakes","Soup"] },
        { t:"Cakes & Sweets", icon:"üéÇ", s:["Layer cake","Cookies","Milk desserts"] },
        { t:"Jam ‚Ä¢ Pickle ‚Ä¢ Sauce", icon:"üçØ", s:["Jam","Pickles","Tomato/pepper"] },
        { t:"Regional / Winter Prep", icon:"üß∫", s:["Noodles","Tarhana","Manti"] },
        { t:"Diet / Vegan / GF", icon:"ü•ó", s:["Fit bowls","Vegan","Gluten‚Äëfree"] },
        { t:"Jewelry", icon:"üíç", s:["Bracelet","Necklace","Earrings"] },
        { t:"Baby & Kids", icon:"üß∏", s:["Rattle","Booties","Blanket"] },
        { t:"Knitwear", icon:"üßµ", s:["Cardigan","Scarf","Shawl"] },
        { t:"Sewing / Tailor", icon:"‚úÇÔ∏è", s:["Hemming","Zipper","Custom sew"] },
        { t:"Macrame & Decor", icon:"ü™¢", s:["Wall hanging","Plant hanger","Keychain"] },
        { t:"Home Decor & Acc.", icon:"üè†", s:["Pillow","Wreath","Frame"] },
        { t:"Candles & Scents", icon:"üïØÔ∏è", s:["Soy/beeswax","Room spray","Gift set"] },
        { t:"Natural Soap & Cosmetics", icon:"üßº", s:["Olive oil soap","Solid shampoo","Lip balm"] },
        { t:"Amigurumi & Toys", icon:"üß∂", s:["Keychain","Magnet","Figure"] },
      ],
      ar: [
        { t:"Ÿàÿ¨ÿ®ÿßÿ™", icon:"üçΩÔ∏è", s:["ÿ®Ÿäÿ™Ÿä","ŸÖÿπÿ¨ŸÜÿßÿ™ ŸÖÿßŸÑÿ≠ÿ©","ÿ¥Ÿàÿ±ÿ®ÿ©"] },
        { t:"ŸÉÿπŸÉ Ÿàÿ≠ŸÑŸàŸäÿßÿ™", icon:"üéÇ", s:["ŸÉŸäŸÉ","ÿ®ÿ≥ŸÉŸàŸäÿ™","ÿ≠ŸÑŸàŸäÿßÿ™ ÿ£ŸÑÿ®ÿßŸÜ"] },
        { t:"ŸÖÿ±ÿ®Ÿâ ‚Ä¢ ŸÖÿÆŸÑŸÑ ‚Ä¢ ÿµŸàÿµ", icon:"üçØ", s:["ŸÖÿ±ÿ®Ÿâ","ŸÖÿÆŸÑŸÑÿßÿ™","ÿµŸÑÿµÿ©"] },
        { t:"ÿ™ÿ±ÿßÿ´Ÿä / ŸÖÿ§ŸàŸÜÿ©", icon:"üß∫", s:["ŸÖŸÉÿ±ŸàŸÜÿ©","ÿ∑ÿ±ÿ≠ŸÜÿ©","ŸÖÿßŸÜÿ∑Ÿä"] },
        { t:"ÿ≠ŸÖŸäÿ© / ŸÜÿ®ÿßÿ™Ÿä / GF", icon:"ü•ó", s:["ÿ£ÿ∑ÿ®ÿßŸÇ ÿµÿ≠Ÿäÿ©","ŸÜÿ®ÿßÿ™Ÿä","ÿÆÿßŸÑŸç ŸÖŸÜ ÿßŸÑÿ∫ŸÑŸàÿ™ŸäŸÜ"] },
        { t:"ÿ•ŸÉÿ≥ÿ≥Ÿàÿßÿ±ÿßÿ™", icon:"üíç", s:["ÿ£ÿ≥ÿßŸàÿ±","ŸÇŸÑÿßÿ¶ÿØ","ÿ£ŸÇÿ±ÿßÿ∑"] },
        { t:"ÿ±ÿ∂ÿπ Ÿàÿ£ÿ∑ŸÅÿßŸÑ", icon:"üß∏", s:["ÿÆÿ¥ÿÆŸäÿ¥ÿ©","ÿ≠ÿ∞ÿßÿ° ÿµŸàŸÅŸä","ÿ®ÿ∑ÿßŸÜŸäÿ©"] },
        { t:"ÿ™ÿ±ŸäŸÉŸà", icon:"üßµ", s:["ÿ¨ÿßŸÉŸäÿ™","Ÿàÿ¥ÿßÿ≠","ÿ¥ÿßŸÑ"] },
        { t:"ÿÆŸäÿßÿ∑ÿ©/ÿ™ŸÅÿµŸäŸÑ", icon:"‚úÇÔ∏è", s:["ÿ™ŸÇÿµŸäÿ±","ÿ≥ÿ≠ÿßÿ®","ÿ™ŸÅÿµŸäŸÑ ÿÆÿßÿµ"] },
        { t:"ŸÖÿßŸÉÿ±ÿßŸÖŸá ŸàÿØŸäŸÉŸàÿ±", icon:"ü™¢", s:["ÿ™ÿπŸÑŸäŸÇÿ© ÿ≠ÿßÿ¶ÿ∑","ÿ≠ÿßŸÖŸÑ ŸÜÿ®ÿßÿ™","ŸÖŸäÿØÿßŸÑŸäÿ©"] },
        { t:"ÿØŸäŸÉŸàÿ± ÿßŸÑŸÖŸÜÿ≤ŸÑ", icon:"üè†", s:["Ÿàÿ≥ÿßÿØÿ©","ÿ•ŸÉŸÑŸäŸÑ","ÿ•ÿ∑ÿßÿ±"] },
        { t:"ÿ¥ŸÖŸàÿπ Ÿàÿ±Ÿàÿßÿ¶ÿ≠", icon:"üïØÔ∏è", s:["ÿµŸàŸäÿß/ŸÜÿ≠ŸÑ","ŸÖÿπÿ∑ÿ± ÿ∫ÿ±ŸÅ","ÿ∑ŸÇŸÖ ŸáÿØÿßŸäÿß"] },
        { t:"ÿµÿßÿ®ŸàŸÜ ÿ∑ÿ®ŸäÿπŸä Ÿàÿ™ÿ¨ŸÖŸäŸÑŸä", icon:"üßº", s:["ÿ≤Ÿäÿ™ ÿ≤Ÿäÿ™ŸàŸÜ","ÿ¥ÿßŸÖÿ®Ÿà ÿµŸÑÿ®","ÿ®ŸÑÿ≥ŸÖ ÿ¥ŸÅÿßŸá"] },
        { t:"ÿ£ŸÖŸäÿ¨Ÿàÿ±ŸàŸÖŸä Ÿàÿ£ŸÑÿπÿßÿ®", icon:"üß∂", s:["ŸÖŸäÿØÿßŸÑŸäÿ©","ŸÖÿ∫ŸÜÿßÿ∑Ÿäÿ≥","ŸÅŸäÿ¨Ÿàÿ±"] },
      ],
      de: [
        { t:"Speisen", icon:"üçΩÔ∏è", s:["Hausmannskost","Herzhafte Backwaren","Suppe"] },
        { t:"Torten & S√º√ües", icon:"üéÇ", s:["Torte","Kekse","Milchdesserts"] },
        { t:"Marmelade ‚Ä¢ Pickles ‚Ä¢ So√üen", icon:"üçØ", s:["Marmelade","Eingelegtes","Tomaten/Pfeffer"] },
        { t:"Regional / Wintervorrat", icon:"üß∫", s:["Nudeln","Tarhana","Manti"] },
        { t:"Di√§t / Vegan / GF", icon:"ü•ó", s:["Fit Bowls","Vegan","Glutenfrei"] },
        { t:"Schmuck", icon:"üíç", s:["Armband","Kette","Ohrringe"] },
        { t:"Baby & Kinder", icon:"üß∏", s:["Rassel","Sch√ºhchen","Decke"] },
        { t:"Strickwaren", icon:"üßµ", s:["Cardigan","Schal","Tuch"] },
        { t:"N√§hen / Schneiderei", icon:"‚úÇÔ∏è", s:["Saum","Rei√üverschluss","Ma√üanfert."] },
        { t:"Makramee & Deko", icon:"ü™¢", s:["Wandbehang","Pflanzenh√§nger","Schl√ºsselanh."] },
        { t:"Wohndeko & Access.", icon:"üè†", s:["Kissen","T√ºrkranz","Rahmen"] },
        { t:"Kerzen & D√ºfte", icon:"üïØÔ∏è", s:["Soja/Bienenwachs","Raumspray","Geschenkset"] },
        { t:"Naturseife & Kosmetik", icon:"üßº", s:["Oliven√∂lseife","Festes Shampoo","Lippenbalsam"] },
        { t:"Amigurumi & Spielzeug", icon:"üß∂", s:["Schl√ºsselanh.","Magnet","Figur"] },
      ],
    };

    const qs = (s, r=document)=> r.querySelector(s);
    const qsa = (s, r=document)=> [...r.querySelectorAll(s)];

    const state = {
      lang: localStorage.getItem('lang') || 'tr',
      role: localStorage.getItem('role') || 'seller',
      name: localStorage.getItem('full_name') || '',
      membership: localStorage.getItem('membership') || 'standard' // 'standard' | 'platinum'
    };

    function applyDir(){
      document.documentElement.lang = state.lang;
      document.documentElement.dir = (state.lang==='ar') ? 'rtl' : 'ltr';
    }

    function i18nPaint(){
      const pack = STR[state.lang] || STR.tr;
      const brandTxt = qs('#brandTxt'); if(brandTxt) brandTxt.textContent = pack.brand;
      qsa('[data-i="home"]').forEach(n=> n.textContent = pack.home);
      qsa('[data-i="messages"]').forEach(n=> n.textContent = pack.messages);
      qsa('[data-i="notifications"]').forEach(n=> n.textContent = pack.notifications);
      qsa('[data-i="profile"]').forEach(n=> n.textContent = pack.profile);
      qsa('[data-i="logout"]').forEach(n=> n.textContent = pack.logout);
      qsa('[data-i="post"]').forEach(n=> n.textContent = pack.post);
      qsa('[data-i="cats"]').forEach(n=> n.textContent = pack.cats);

      const sh = qs('#showcaseHead'); if(sh) sh.textContent = pack.showcase;
      const lh = qs('#latestHead'); if(lh) lh.textContent = pack.latest20;

      const wt = qs('#welcomeTitle'); if(wt) wt.textContent = pack.welcomeTitle(state.name);
      const ws = qs('#welcomeSub'); if(ws) ws.textContent = pack.welcomeSub; // optional (element removed)

      // Legal links
      const L = pack.legal; const cont = qs('#legalLinks'); if(cont){
        cont.innerHTML='';
        const links = [
          {href:'/legal/gizlilik', label:L.privacy},
          {href:'/legal/hakkimizda', label:L.about},
          {href:'/legal/iletisim', label:L.contact},
          {href:'/legal/kullanim-sartlari', label:L.terms},
          {href:'/legal/kvkk-aydinlatma', label:L.kvkk},
          {href:'/legal/mesafeli-satis-sozlesmesi', label:L.distance},
          {href:'/legal/teslimat-iade', label:L.returns},
        ];
        links.forEach(({href,label})=>{ const a=document.createElement('a'); a.href=href; a.textContent=label; cont.appendChild(a); });
      }

      renderCats();
      renderShowcase();
      renderLatest();
      phraseIndex = 0; setPhrase();
    }

    // Rotating phrases
    const phrases = {
      tr:["Amacƒ±mƒ±z: ev hanƒ±mlarƒ±na b√ºt√ße katkƒ±sƒ± saƒülamak.","El emeƒüi √ºr√ºnler adil fiyata.","≈ûeffaf fiyat, net teslimat.","G√ºvenli √∂deme, kolay iade."],
      en:["Our aim: support household budgets of women.","Handmade at fair prices.","Transparent pricing, clear delivery.","Secure payments, easy returns."],
      ar:["ŸáÿØŸÅŸÜÿß: ÿØÿπŸÖ ŸÖŸäÿ≤ÿßŸÜŸäÿ© ÿ±ÿ®Ÿëÿßÿ™ ÿßŸÑÿ®ŸäŸàÿ™.","ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸäÿØŸàŸäÿ© ÿ®ÿ≥ÿπÿ± ÿπÿßÿØŸÑ.","ÿ£ÿ≥ÿπÿßÿ± ÿ¥ŸÅÿßŸÅÿ© Ÿàÿ™ÿ≥ŸÑŸäŸÖ Ÿàÿßÿ∂ÿ≠.","ÿØŸÅÿπ ÿ¢ŸÖŸÜ Ÿàÿ•ÿ±ÿ¨ÿßÿπ ÿ≥ŸáŸÑ."],
      de:["Ziel: Haushaltsbudgets st√§rken.","Handgemachtes zum fairen Preis.","Transparente Preise, klare Lieferung.","Sichere Zahlung, einfache R√ºckgabe."]
    };

    let phraseIndex = 0; let phraseTimer;
    function setPhrase(){
      const p = phrases[state.lang][phraseIndex % phrases[state.lang].length];
      const box = qs('#phraseBox'); if(box){ box.textContent = p; }
      phraseIndex++;
      clearTimeout(phraseTimer);
      phraseTimer = setTimeout(setPhrase, 3500);
    }

    // Render Categories
    function renderCats(){
      const grid = qs('#catsGrid'); if(!grid) return; grid.innerHTML = '';
      const pack = STR[state.lang];
      const list = CATS[state.lang] || CATS.tr;
      list.forEach((c, idx)=>{
        const el = document.createElement('div');
        el.className = 'cat c' + ((idx % 5) + 1);
        const subs = (c.s||[]).slice(0,3).map(x=> `<span class="s">${x}</span>`).join(' ');
        const icon = c.icon || 'üóÇÔ∏è';
        const link = '/search?cat=' + encodeURIComponent(c.t) + '&lang=' + state.lang;
        el.innerHTML = `<h4>${icon} ${c.t}</h4><div class="subs">${subs}</div><a href="${link}" class="more">${pack.more}</a>`;
        el.style.cursor='pointer';
        el.onclick = ()=>{ window.location.href = link; };
        grid.appendChild(el);
      });
      startCatColorCycle();
    }

    // Rotate category card colors continuously
    function startCatColorCycle(){
      const cards = qsa('.cat');
      let tick = 0;
      clearInterval(window.__catSwapTimer);
      window.__catSwapTimer = setInterval(()=>{
        cards.forEach((el, i)=>{
          const cls = 'c' + (((i + tick) % 5) + 1);
          el.className = 'cat ' + cls;
        });
        tick++; if(tick>99999) tick=0;
      }, 3000);
    }

    // Ads rendering (no fake data)
    function getAdsData(){
      let featured = []; let latest = [];
      try{ featured = JSON.parse(localStorage.getItem('featured_ads')||'[]'); }catch{}
      try{ latest = JSON.parse(localStorage.getItem('ads')||'[]'); }catch{}
      return {featured, latest};
    }
    function renderAds(gridSel, items){
      const grid = typeof gridSel==='string' ? qs(gridSel) : gridSel; if(!grid) return;
      const pack = STR[state.lang];
      grid.innerHTML='';
      if(!items || !items.length){
        const d = document.createElement('div'); d.className='adCard'; d.innerHTML = `<div class="adBody">${pack.noAds}</div>`; grid.appendChild(d); return;
      }
      items.forEach(a=>{
        const el = document.createElement('a');
        el.className='adCard';
        el.href = a.url || ('/ad/' + (a.id||''));
        const bg = a.img ? `background-image:url('${a.img}'); background-size:cover; background-position:center;` : '';
        el.innerHTML = `<div class="adThumb" style="${bg}"></div><div class="adBody"><h4 class="adTitle">${a.title||'ƒ∞lan'}</h4><div class="adMeta"><span>${a.cat||''}</span><b>${a.price||''}</b></div></div>`;
        grid.appendChild(el);
      });
    }
    function renderShowcase(){
      const {featured} = getAdsData();
      const limit = (state.membership==='platinum') ? featured.length : Math.min(featured.length, 8);
      renderAds('#showcaseGrid', featured.slice(0, limit));
    }
    function renderLatest(){
      const {latest} = getAdsData();
      renderAds('#latestGrid', (latest||[]).slice(0,20));
    }

    // Navigation actions
    function goHome(){ window.location.href = '/'; }
    function postListing(){ if(state.role==='seller'){ window.location.href = '/portal/seller?new=listing'; } else { alert((state.lang==='en')?'Only makers can post a listing.': (state.lang==='de')?'Nur Anbieterinnen k√∂nnen Anzeigen erstellen.': (state.lang==='ar')?'ŸÅŸÇÿ∑ ÿßŸÑŸÖŸèŸÜÿ™Ÿêÿ¨ÿßÿ™ ŸäŸÖŸÉŸÜŸáŸÜ ÿ•ŸÜÿ¥ÿßÿ° ÿ•ÿπŸÑÿßŸÜ.': 'Yalnƒ±zca √úreten El ilan verebilir.'); } }
    function logout(){ window.location.href='/logout?next=/'; }

    // Support bubble
    function supOpen(){ const win=qs('#supportWin'); if(!win) return; win.classList.add('open'); const log=qs('#supLog'); if(log){ log.innerHTML=''; addBot(STR[state.lang].support.hello); } }
    function supClose(){ const win=qs('#supportWin'); if(!win) return; win.classList.remove('open'); const log=qs('#supLog'); if(log){ log.innerHTML=''; } }
    function addMe(t){ const log=qs('#supLog'); if(!log) return; const d=document.createElement('div'); d.className='me'; d.textContent=t; log.appendChild(d); log.scrollTop=99999; }
    function addBot(t){ const log=qs('#supLog'); if(!log) return; const d=document.createElement('div'); d.className='bot'; d.textContent=t; log.appendChild(d); log.scrollTop=99999; }

    // Bindings
    function bind(){
      const sel = qs('#langSel'); if(sel){ sel.value = state.lang; sel.addEventListener('change', (e)=>{ state.lang = e.target.value; localStorage.setItem('lang', state.lang); applyDir(); i18nPaint(); }); }
      const hbB = qs('#homeBtnB'); if(hbB) hbB.onclick = goHome;
      const prof = qs('#profileBtn'); if(prof) prof.onclick = ()=>{ window.location.href = '/profile'; };
      const lo = qs('#logoutBtn'); if(lo) lo.onclick = logout;
      const pl = qs('#postListing'); if(pl) pl.onclick = postListing;
      const mb = qs('#msgBtnB'); if(mb) mb.onclick = ()=>{ window.location.href = '/messages'; };
      const nb = qs('#notiBtnB'); if(nb) nb.onclick = ()=>{ window.location.href = '/notifications'; };
      if(state.role !== 'seller' && pl){ pl.classList.add('hide'); }
      const sBtn = qs('#supportBtn'); const sClose = qs('#supClose'); const sSend = qs('#supSend'); const sInput = qs('#supInput');
      if(sBtn) sBtn.onclick = supOpen; if(sClose) sClose.onclick = supClose; if(sSend) sSend.onclick = ()=>{ const v=sInput? sInput.value.trim():''; if(!v) return; addMe(v); if(sInput) sInput.value=''; setTimeout(()=> addBot(STR[state.lang].support.sent), 600); };
      if(sInput) sInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); const v=sInput.value.trim(); if(!v) return; addMe(v); sInput.value=''; setTimeout(()=> addBot(STR[state.lang].support.sent), 600); } });
    }

    // Adjust bottom safe area based on actual footer height
    function adjustBottomSafeArea(){
      const bar = qs('.bottombar');
      const barH = bar ? bar.offsetHeight : 0;
      document.body.style.paddingBottom = (barH + 8) + 'px';
    }

    // --- Smoke tests (console) ---
    function runSmokeTests(){
      console.group('Home smoke tests');
      console.assert(!!qs('#welcomeTitle'), '#welcomeTitle exists');
      console.assert((qs('#catsGrid')||{}).children?.length > 0, 'category cards rendered');
      console.assert((qs('#legalLinks')||{}).children?.length > 0, 'legal links rendered');
      console.assert(qs('#postListing')? true : true, 'postListing button present');
      console.groupEnd();
    }

    (function init(){
      applyDir();
      bind();
      i18nPaint();
      adjustBottomSafeArea();
      window.addEventListener('resize', adjustBottomSafeArea);
      runSmokeTests();
    })();
  </script>
</body>
</html>
